<!DOCTYPE html>
<html lang="cn">
<head>
	<meta charset="UTF-8">
	<title>Bilibili v.mini</title>
	<style>
		html, body{
			margin: 0;
			height: 100%;
		}
		webview{
			width: 100%;
			height: 100%;
		}
	</style>
</head>
<body>
	<webview id="vw" src="http://m.bilibili.com/index.html" useragent="bilimini Mobile like (iPhone or Android) whatever" preload="./inject.js"></webview>
	<script>
		const ipc = require('electron').ipcRenderer;
		var vw = document.getElementById('vw');
		vw.addEventListener('did-finish-load', function() {
			// vw.openDevTools();
		});
		vw.addEventListener('load-commit', function() {
			if( vw.getURL().indexOf('video/av') > -1 ) {
				ipc.send('asynchronous-message', 'video');
			} else {
				ipc.send('asynchronous-message', 'default');
			}
		});
	</script>
</body>
</html>